



<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>My 2 cents on Zend_Search_Lucene Update Problems &mdash; Whitewashing</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/disqus.js"></script>
    <script type="text/javascript" src="../../../_static/ga.js"></script>
    <link rel="shortcut icon" href="../../../_static/tinkerer.ico"/>
    
    <link rel="top" title="Whitewashing" href="../../../index.html" />
    <link rel="next" title="Integrated Zend_Layout into this blog" href="../17/integrated-zend-layout-into-this-blog.html" />
    <link rel="prev" title="Introducing: Zend Controller Scaffolding" href="../25/introducing-zend-controller-scaffolding.html" />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.html" /> 
  </head>
  <body>
<div class="container">
    <div id="header" class="span-8">
        <a href="../../../index.html"><img src="../../../_static/logo.jpg" alt="Whitewashing.de" /></a>
    </div>
    <div class="span-11" id="about">
        <p>
            Whitewashing is the blog of Benjamin Eberlei and covers topics in software-development and object-oriented-design. Benjamin works
            for <a href="http://qafoo.com/" target="_blank">Qafoo</a> and you can book him for consulting and trainings.
        </p>
    </div>
    <div class="span-5 last">
        <p class="buttons" style="text-align: right">
            <a href="https://twitter.com/beberlei"><img src="../../../_static/twitter-logo.png" alt="Follow me on twitter" height="50" /></a>
            <a href="http://www.whitewashing.de/rss.xml"><img src="../../../_static/rss2.png" alt="Subscribe to RSS" height="50" /></a>
            <a href="https://github.com/beberlei"><img src="../../../_static/github-logo.png" alt="My Github Profile" height="50" /></a>
        </p>
    </div>
</div>



    <div class="document">
<div class="container">
    
    <div class="span-24 content">
      <div>
        <div>
          <div id="2008-05-18-my-2-cents-on-zend-search-lucene-update-problems">
            
            
    
    <div class="related">
        <ul>
            <li>
                 &laquo; <a href="../25/introducing-zend-controller-scaffolding.html">Introducing: Zend Controller Scaffolding</a>
            </li>
            <li class="right">
                <a href="../17/integrated-zend-layout-into-this-blog.html">Integrated Zend_Layout into this blog</a> &raquo; 
            </li>
        </ul>
    </div>
    
        <div class="timestamp postmeta">
            <span>May 18, 2008</span> 
        </div>
    <div class="section" id="my-2-cents-on-zend-search-lucene-update-problems">
<h1>My 2 cents on Zend_Search_Lucene Update Problems</h1>
<p><a class="reference external" href="http://framework.zend.com">Zend_Search_Lucene</a> (or Lucene in
general) does not support an update statement, therefore we must check
via find() if a specific article that should be updated already exists.</p>
<p>Numerous solutions exist for this problem (<a class="reference external" href="http://devzone.zend.com/content/zendcon_07_slides/Evron_Shahar_Indexing_With_Zend_Search_Lucene-ZendCon07.pdf">for example this PDF
Tutorial by a Zend
Programmer</a>).
Mine looks as follows. The first thing is to Set an Analyzer other from
the default one. The Default Analyzer only looks at letters, not at
numbers.</p>
<blockquote>
<div><div class="highlight-python"><pre>Zend_Search_Lucene_Analysis_Analyzer::setDefault(new
    Zend_Search_Lucene_Analysis_Analyzer_Common_Utf8Num_CaseInsensitive()
);
$index = Zend_Search_Lucene::open('/path/to/index/directory');</pre>
</div>
</div></blockquote>
<p>We can now save an identifier containing letters and numbers, for
example the md5 string of the Article Database ID.</p>
<blockquote>
<div><div class="highlight-python"><pre>$doc = new Zend_Search_Lucene_Document();
$field = Zend_Search_Lucene_Field::Keyword('id', md5($data['id']));
$doc-&gt;addField($field);
$index-&gt;addDocument($doc);</pre>
</div>
</div></blockquote>
<p>Before updating an entry you have to delete any entry that has been
indexed before:</p>
<blockquote>
<div><div class="highlight-python"><pre>$hits = $index-&gt;find('id:'.md5($articleID));
foreach($hits AS $hit) {
    $index-&gt;delete($hit-&gt;id);
}</pre>
</div>
</div></blockquote>
<p>The <a class="reference external" href="http://devzone.zend.com/content/zendcon_07_slides/Evron_Shahar_Indexing_With_Zend_Search_Lucene-ZendCon07.pdf">Tutorial Talk on Search
Lucene</a>
(given above) uses an extended version of this delete routine snippet
that also checks if an article is up to date and does not have to be
reindexed and deletes multiple entries of one article.</p>
</div>

    
    <div class="postmeta">
        
        <div class="author">
            <span>Posted by beberlei <kontakt@beberlei.de></span>
        </div>
        
        
        
    </div>
    <div id="disqus_thread"></div><script type="text/javascript">    var disqus_shortname = "whitewashing";    var disqus_identifier = "2008/05/18/my-2-cents-on-zend-search-lucene-update-problems";    disqus_thread();</script><noscript>Please enable JavaScript to view the    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'whitewashing';
                var disqus_url = 'http://www.whitewashing.de/2008/05/18/my-2-cents-on-zend-search-lucene-update-problems.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
          </div>         
        </div>
      </div>
    </div>

    <div class="span-24 last">
        
          
            <div class="yui-b" id="sidebar">
              
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

<div class="widget">
    <h3>Recent Posts</h3>
    <ul>
        <li class="recent_post">
            <a href="../../../2013/09/04/decoupling_from_symfony_security_and_fosuserbundle.html">Decoupling from Symfony Security and FOSUserBundle</a>
        </li>
        <li class="recent_post">
            <a href="../../../2013/08/19/speedup_symfony2_on_vagrant_boxes.html">Speedup Symfony2 on Vagrant boxes</a>
        </li>
        <li class="recent_post">
            <a href="../../../2013/08/09/your_service_layer_benefits_from_a_dispatcher.html">Your Service Layer benefits from a Dispatcher</a>
        </li>
        <li class="recent_post">
            <a href="../../../2013/07/24/doctrine_and_domainevents.html">Doctrine and Domain Events</a>
        </li>
        <li class="recent_post">
            <a href="../../../2013/06/27/extending_symfony2__controller_utilities.html">Extending Symfony2: Controller Utilities</a>
        </li>
        <li class="recent_post">
            <a href="../../../2013/06/24/bounded_contexts.html">Bounded Contexts</a>
        </li>
        <li class="recent_post">
            <a href="../../../2013/05/23/symfony2_on_windows_azure_websites.html">Symfony2 on Windows Azure Websites</a>
        </li>
        <li class="recent_post">
            <a href="../../../2013/04/12/traits_are_static_access.html">Traits are Static Access</a>
        </li>
        <li class="recent_post">
            <a href="../../../2013/04/06/a_failed_side_project.html">Lessons learned: A failed side project</a>
        </li>
        <li class="recent_post">
            <a href="../../../2013/03/12/code_coffee_bonn.html">Code & Coffee Bonn</a>
        </li>
    </ul>
</div>

        </div>
      </div>
            </div> 
          
        
    </div>
</div>

      <div class="clearer"></div>
    </div>
<div class="container">
    <div class="span-24 content">
        <div class="footer">
            &copy; Copyright 2008-2012, Benjamin Eberlei.
            Powered by <a href="http://www.tinkerer.me/">Tinkerer</a> and <a href="http://sphinx.pocoo.org/">Sphinx</a>.

        
        </div>
    </div>
</div>

  </body>
</html>